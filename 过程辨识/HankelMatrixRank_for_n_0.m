g = [ ...
1.00 0.80 0.65 0.54 0.46 0.39 0.35 0.31 ...
0.28 0.26 0.24 0.23 0.22 0.21 0.20 0.19 ...
0.19 0.18 0.18 0.18 0.17 0.17 0.17 0.16 ...
0.16 0.15 0.15 0.15 0.15 0.14 0.14 0.14 ...
0.13 0.13 0.13 0.13 0.12 0.12 0.12 0.12 ...
0.12 0.11 0.11 0.11 0.10 0.10 0.10 ];
L = length(g);
max_l = 6;
D = zeros(1, max_l);

for l = 2:max_l
    num = 0;
    den = 0;

    % ===== 分子：H(l,k) =====
    for k = 1:(L - 2*l + 2)
        H1 = hankel( ...
            g(k : k+l-1), ...
            g(k+l-1 : k+2*l-2) ...
        );
        num = num + det(H1);
    end

    % ===== 分母：H(l+1,k) =====
    for k = 1:(L - 2*l)
        H2 = hankel( ...
            g(k : k+l), ...
            g(k+l : k+2*l) ...
        );
        den = den + det(H2);
    end

    D(l) = (num/(L - 2*l + 2)) / (den/(L - 2*l));
end

disp(D)

